<div class="container py-4">

  <!-- Bloc principal de l'√©v√©nement -->
  <div class="card position-relative mb-5" *ngIf="event; else loadingOrError">

    <!-- Bouton favoris -->
    <button class="btn btn-light position-absolute top-0 end-0 m-2 shadow-sm" (click)="toggleFavorite()">
  <span class="fs-4" [class.text-danger]="isFavorite" [class.text-secondary]="!isFavorite">
    {{ isFavorite ? '‚ù§Ô∏è' : 'ü©∂' }}
  </span>
</button>

    <!-- Image principale -->
    <img *ngIf="event.imageUrl" [src]="event.imageUrl" alt="Image principale de l'√©v√©nement" class="card-img-top rounded-top">

    <div class="card-body">
      <h1 class="card-title">{{ event.titre_evenement }}</h1>
      <p class="card-text"><strong>Description :</strong> {{ event.description_evenement }}</p>

      <ul class="list-group list-group-flush my-3">
        <li class="list-group-item"><strong>Lieu :</strong> {{ event.id_lieu }}</li>
        <li class="list-group-item"><strong>Date de d√©but :</strong> {{ event.date_debut | date:'longDate' }}</li>
        <li class="list-group-item"><strong>Date de fin :</strong> {{ event.date_fin | date:'longDate' }}</li>
        <li class="list-group-item"><strong>Th√©matique :</strong> {{ event.id_thematique }}</li>
        <li class="list-group-item"><strong>P√©riode :</strong> {{ event.id_periode }}</li>
        <li class="list-group-item"><strong>Cat√©gorie :</strong> {{ event.id_categorie }}</li>
        <li class="list-group-item"><strong>Civilisation :</strong> {{ event.id_civilisation }}</li>
      </ul>

      <div class="mt-4">
        <h4>Contenu d√©taill√©</h4>
        <p>{{ event.detailedContent }}</p>
      </div>
    </div>
  </div>

  <!-- Section Archives multim√©dia -->
  <div class="mb-5">
    <h3>Archives multim√©dia</h3>
    <div *ngIf="event.archives?.length > 0; else noArchives" class="row g-3">
      <div *ngFor="let archive of event.archives" class="col-12 col-md-6 col-lg-4">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <ng-container [ngSwitch]="archive.type">
              <img *ngSwitchCase="'image'" [src]="archive.url" [alt]="archive.description" class="img-fluid rounded mb-2">
              <video *ngSwitchCase="'video'" [src]="archive.url" controls class="w-100 rounded mb-2"></video>
              <audio *ngSwitchCase="'audio'" [src]="archive.url" controls class="w-100 mb-2"></audio>
              <a *ngSwitchDefault [href]="archive.url" target="_blank" class="btn btn-outline-secondary mb-2 w-100">Voir le document</a>
            </ng-container>
            <p class="card-text">{{ archive.description }}</p>
          </div>
        </div>
      </div>
    </div>
    <ng-template #noArchives>
      <p class="text-muted mt-2">Aucune archive disponible pour cet √©v√©nement.</p>
    </ng-template>
  </div>

  <!-- Section Commentaires -->
  <div>
    <h3>Commentaires</h3>
    <form (submit)="addComment()">
      <div class="mb-3">
        <label for="commentInput" class="form-label">Ajoutez un commentaire</label>
        <input type="text" id="commentInput" class="form-control" [(ngModel)]="newComment" name="comment" placeholder="Votre commentaire...">
      </div>
      <button type="submit" class="btn btn-primary">Envoyer</button>
    </form>
  </div>
</div>

<!-- Loading ou Erreur -->
<ng-template #loadingOrError>
  <div *ngIf="errorMessage; else loading">
    <div class="alert alert-danger mt-4" role="alert">
      {{ errorMessage }}
    </div>
  </div>
  <ng-template #loading>
    <div class="text-center my-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-3">Chargement des donn√©es...</p>
    </div>
  </ng-template>
</ng-template>
